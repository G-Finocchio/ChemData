coef.one=coef.pls3[1:41,]
ind=grepl(colnames(xs)[i],coef.one[,1],fixed=TRUE); coef.one=rbind(coef.one,t(c(paste(colnames(xs[i]),"last")),sum(as.numeric(coef.one[ind,2]))))
c(paste(colnames(xs[i]),"last")),sum(as.numeric(coef.one[ind,2]))
c(paste(colnames(xs[i]),"last")),sum(as.numeric(coef.one[ind,2])
c(paste(colnames(xs[i]),"last")),sum(as.numeric(coef.one[ind,2]
c(paste(colnames(xs[i]),"last"),sum(as.numeric(coef.one[ind,2])
)
)
#get all coefficients from the constraints
coef.one=coef.pls3[1:41,]
ind=grepl(colnames(xs)[i],coef.one[,1],fixed=TRUE); coef.one=rbind(coef.one,c(paste(colnames(xs[i]),"last"),sum(as.numeric(coef.one[ind,2]))))
coef.one
coef.one=coef.pls3[1:41,]
for (i in 1:4) {ind=grepl(colnames(xs)[i],coef.one[,1],fixed=TRUE); coef.one=rbind(coef.one,c(paste(colnames(xs[i]),"last"),sum(as.numeric(coef.one[ind,2]))))}
coef.one
coef.two=coef.pls3[c(42:516),]
coef.two
coef.pls3[c(42:517),]
coef.two
colnames(xf)
i=1
colnames(xf)[i]
paste(colnames(xf)[i],colnames(xs[2],sep=":"))
paste(colnames(xf)[i],colnames(xs[2]),sep=":")
grepl(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),coef.two[,1],fixed=TRUE)
coef.two[,1]
ind=grepl(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),coef.two[,1],fixed=TRUE)
c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":")),"last" , sum(as.numeric(coef.two[ind,2])))
rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last") , sum(as.numeric(coef.two[ind,2])))
)
coef.two=coef.pls3[c(42:516),]
ind=grepl(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last") , sum(as.numeric(coef.two[ind,2]))))}
ind=grepl(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last") , sum(as.numeric(coef.two[ind,2]))))
coef.two
coef.two=coef.pls3[c(42:516),]
for (i in 1:ncol(xf))
for (j in 2:4)
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last") , sum(as.numeric(coef.two[ind,2]))))
coef.twp
coef.two
coef.two=coef.pls3[c(42:516),]
for (i in 1:ncol(xf))
{ for (j in 2:4)
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last") , sum(as.numeric(coef.two[ind,2]))))}
coef.two
dim(coef.two)
coef.two=coef.pls3[c(42:516),]
dim(coef.two)
coef.two=coef.pls3[c(42:516),]
for (i in 1:ncol(xf))
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last") , sum(as.numeric(coef.two[ind,2]))))
j=2
coef.two=coef.pls3[c(42:516),]
for (i in 1:ncol(xf))
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last") , sum(as.numeric(coef.two[ind,2]))))
coef.two
coef.two=coef.pls3[c(42:516),]
j=1
j=2
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last") , sum(as.numeric(coef.two[ind,2]))))
coef.two
coef.two=coef.pls3[c(42:516),]
for (i in 1:ncol(xf))
# { for (j in 2:4)
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last") , sum(as.numeric(coef.two[ind,2]))))
#}
coef.two
i=1
coef.two=coef.pls3[c(42:516),]
# { for (j in 2:4)
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last") , sum(as.numeric(coef.two[ind,2]))))
coef.two=coef.pls3[c(42:516),]
# { for (j in 2:4)
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last") , sum(as.numeric(coef.two[ind,2]))))
coef.two
i=2
# { for (j in 2:4)
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last") , sum(as.numeric(coef.two[ind,2]))))
coef.two
ncol(xf)
i=3
# { for (j in 2:4)
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last") , sum(as.numeric(coef.two[ind,2]))))
coef.two
i=39
# { for (j in 2:4)
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last") , sum(as.numeric(coef.two[ind,2]))))
coef.two
i=30
# { for (j in 2:4)
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last") , sum(as.numeric(coef.two[ind,2]))))
coef.two
coef.two=coef.pls3[c(42:516),]
for (i in 1:ncol(xf))
# { for (j in 2:4)
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last") , sum(as.numeric(coef.two[ind,2]))))
coef.two
coef.two=coef.pls3[c(42:516),]
for (i in 1:ncol(xf))
# { for (j in 2:4)
}ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last"),sum(as.numeric(coef.two[ind,2]))))
coef.two=coef.pls3[c(42:516),]
for (i in 1:ncol(xf)){
# { for (j in 2:4)
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last"),sum(as.numeric(coef.two[ind,2]))))
}
coef.two
coef.two=coef.pls3[c(42:516),]
for (i in 1:ncol(xf))
{ for (j in 2:4)
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last"),sum(as.numeric(coef.two[ind,2]))))
}
coef.two[coef.tw0[,2]!=0,]
coef.two=coef.pls3[c(42:516),]
for (i in 1:ncol(xf))
{ for (j in 2:4)
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last"),sum(as.numeric(coef.two[ind,2]))))
}
coef.two[coef.two[,2]!=0,]
coef.two=coef.pls3[c(42:516),]
for (i in 1:ncol(xf))
{ for (j in 1:4)
ind=grepl(paste(colnames(xf)[i],colnames(xs[j]),sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last"),sum(as.numeric(coef.two[ind,2]))))
}
coef.two=coef.two[coef.two[,2]!=0,]
dim(coef.two)
coef.two
dim(coef.two)
coef.two[475:512]
coef.two[475:512,]
colanmes(xf)
colnames(xf)
bb
k=1
(max(bb[k-1],0)+1):bb[k]
j=1
(colnames(xs)[-k])[j]
(colnames(xs)[-k])
coef.two=coef.pls3[c(42:516),]
for (k in 1:4)
for (i in (max(bb[k-1],0)+1):bb[k])
{ for (j in 1:3)
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last"),-sum(as.numeric(coef.two[ind,2]))))
}
coef.two
dim(coef.two)
coef.two=coef.pls3[c(42:516),]
k=2
i=1
j=1
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"
)
i
k
k=2
i=bb[1]
i
j=1
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":")
i
(max(bb[k-1],0)+1)
i=22
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":")
coef.two
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE)
ind
c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last"),-sum(as.numeric(coef.two[ind,2])))
sum(ind)
coef.two=coef.pls3[c(42:516),]
for (k in 1:4)
for (i in (max(bb[k-1],0)+1):bb[k])
{ for (j in 1:3)
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE); if(sum(ind)!=0) coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last"),-sum(as.numeric(coef.two[ind,2]))))
}
dim(coef.two)
coef.two
coef.two=coef.pls3[c(42:516),]
for (k in 1:4){
for (i in (max(bb[k-1],0)+1):bb[k])
{ for (j in 1:3)
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE); if(sum(ind)!=0) coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last"),-sum(as.numeric(coef.two[ind,2]))))
}
}
coef.two
k=1
coef.two=coef.pls3[c(42:516),]
for (i in (max(bb[k-1],0)+1):bb[k])
{ for (j in 1:3)
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE); if(sum(ind)!=0) coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last"),-sum(as.numeric(coef.two[ind,2]))))
}
coef.two
dim(coef.two)
j
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE)
ind
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":")
rbind(coef.two,c(paste(paste(colnames(xf)[i],colnames(xs[2]),sep=":"),"last"),-sum(as.numeric(coef.two[ind,2])))
)
coef.two=coef.pls3[c(42:516),]
for (k in 1:4){
for (i in (max(bb[k-1],0)+1):bb[k])
{ for (j in 1:3)
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE); if(sum(ind)!=0) coef.two=rbind(coef.two,c(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":","last"),-sum(as.numeric(coef.two[ind,2]))))
}
}
coef.two
dim(coef.two)
coef.two[475:512,]
c(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":","last")
)
coef.two=coef.pls3[c(42:516),]
for (k in 1:4){
for (i in (max(bb[k-1],0)+1):bb[k])
{ for (j in 1:3)
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE); if(sum(ind)!=0) coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),"last"),-sum(as.numeric(coef.two[ind,2]))))
}
}
###
dim(coef.two)
coef.two[475:512,]
sum(ind)
coef.two=coef.pls3[c(42:516),]
for (k in 1:4){
for (i in (max(bb[k-1],0)+1):bb[k])
{ for (j in 1:3)
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),"last"),-sum(as.numeric(coef.two[ind,2]))))
}
}
dim(coef.two)
coef.two[475:515,]
coef.two[1:475]
coef.two[1:475,]
coef.two=coef.pls3[c(42:516),]
k=1
for (i in (max(bb[k-1],0)+1):bb[k])
{ for (j in 1:3)
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),"last"),-sum(as.numeric(coef.two[ind,2]))))
}
coef.two
coef.one=coef.pls3[1:41,]
for (i in 1:4) {ind=grepl(colnames(xs)[i],coef.one[,1],fixed=TRUE); coef.one=rbind(coef.one,c(paste(colnames(xs[i]),"last"),-sum(as.numeric(coef.one[ind,2]))))}
coef.one
coef.two=coef.pls3[c(42:516),]
for (k in 1:4){
for (j in 1:3)
for (i in (max(bb[k-1],0)+1):bb[k])
{
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),"last"),-sum(as.numeric(coef.two[ind,2]))))
}
}
dim(coef.two)
coef.two[475:595,]
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1]
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":")
coef.two[,1]
grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE)
grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),"base 2:ligand 1",fixed=TRUE)
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":")
grepl("ligand 1:base","base 2:ligand 1",fixed=FALSE)
grepl("ligand 1:base","base 2:ligand 1",fixed=TRUE)
grepl("ligand 1:base","ligand 1:base 2",fixed=TRUE)
grepl("ligand 1:base","ligand 1:base 2",fixed=FALSE)
grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE)
grepl("ligand 1:base","base 2:ligand 1",fixed=FALSE)
grepl("ligand 1:base","base 2:ligand 1",fixed=TRUE)
colnames(xx)
i=1
j=1
k=1
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":")
coef.two[,1]
dim(coef.two)
coef.two[475:595,]
coef.two=coef.two[coef.two[,2]!=0,]
dim(coef.two)
568-475
21+14+3+2
21*19+66
22*15*4*3
22*15+22*4+22+3+15*4+15*3+4*3
21*14+21*3+22*2+14*3+14*2+3*2
22*15+22*4+22*3+15*4+15*3+4*3
601-477
124-12
coef.two[475:595,]
coef.two=coef.pls3[c(42:516),]
for (k in 1:4){
for (j in 1:3)
for (i in (max(bb[k-1],0)+1):bb[k])
{
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE); coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),"last"),-sum(as.numeric(coef.two[ind,2]))))
}
}
dim(coef.two)
coef.two[475:595,]
length(coef.two[,2])
(coef.two[,2])
coef.two
595-475
coef.two[475:595,]
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":")
coef.two[,1]
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":")
sub('base 2:ligand 1', 'ligand 1 \\1', string_vec)
sub('base 2:ligand 1', 'ligand 1 \\1', "base 2:ligand 1")
coef.two[475:595,]
colnames(xx)
coef.two[475:595,]
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":")
coef.two[,1]
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":")
colnames(xx)
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":")
paste((colnames(xs)[-k])[j],colnames(xf)[i],sep=":")
grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE)
coef.two=coef.pls3[c(42:516),]
grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE)
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":")
coef.two[,1]
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":")
paste((colnames(xs)[-k])[j],colnames(xf)[i],sep=":")
grepl("base:ligand 1","base 2:ligand 1")
grepl("base:ligand 1","base 2:ligand 1",fixed=TRUE)
grepl("base:ligand 1","base 2:ligand 1",fixed=FALSE)
grepl("base :ligand 1","base 2:ligand 1",fixed=FALSE)
grepl("base :ligand 1","base 2:ligand1")
grep("base :ligand 1","base 2:ligand1")
grepl("base :ligand 1","base 2:ligand1")
("base :ligand 1"-"base 2:ligand1")
("base:ligand 1"-"base 2:ligand1")
string=paste((colnames(xs)[-k])[j],colnames(xf)[i],sep=":")
string
"base 2:ligand 1"
sub(" 2:","",string)
strsplit(string, ":")
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":")
"base 2:ligand 1"
ss=strsplit(string, ":")
ss
ss[[1]][1]
grepl(ss[[1]][1],"base 2:ligand 1")
grepl(ss[[1]][1],coef.two[,1]
)
coef.two[,1]
paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":")
ss=paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":")
strsplit(ss, ":")
ss=colnames(xx)[475]
ss
strsplit(ss, ":")
ss.s=strsplit(ss, ":")
paste(ss.s[[1]][2],ss.s[[1]][1],sep=";")
paste(ss.s[[1]][2],ss.s[[1]][1],sep=":")
ss
ss.s=strsplit(colnames(xx), ":")
ss.s
colnames(xf)
coef.two.rev=coef.pls3[c(42:516),]
ct.s=strsplit(coef.two.rev[,1], ":")
length(ct.s)
coef.two.rev=coef.pls3[c(42:516),]
ct.s=strsplit(coef.two.rev[,1], ":")
for (i in 1:length(ct.s)) {coef.two.rev[i,1]=paste(ct.s[[i]][2],ct.s[[i]][1],sep=":")}
coef.two[1:5,]
coef.two.rev[1:5,]
coef.two=coef.pls3[c(42:516),]
for (k in 1:4){
for (j in 1:3)
for (i in (max(bb[k-1],0)+1):bb[k])
{
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE); if(sum(ind)!=0) coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),"last"),-sum(as.numeric(coef.two[ind,2]))))
}
}
coef.two.rev=coef.pls3[c(42:516),]
ct.s=strsplit(coef.two.rev[,1], ":")
for (i in 1:length(ct.s)) {coef.two.rev[i,1]=paste(ct.s[[i]][2],ct.s[[i]][1],sep=":")}
for (k in 1:4){
for (j in 1:3)
for (i in (max(bb[k-1],0)+1):bb[k])
{
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two.rev[,1],fixed=TRUE); if(sum(ind)!=0) coef.two.rev=rbind(coef.two.rev,c(paste(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),"last"),-sum(as.numeric(coef.two.rev[ind,2]))))
}
}
dim(coef.two)
dim(coef.two.rev)
516-42
dim(xf)
475+40
475+41
coef.two
coef.two=coef.pls3[c(42:516),]
dim(coef.two)
coef.two=coef.pls3[c(42:516),]
for (k in 1:4){
for (j in 1:3)
for (i in (max(bb[k-1],0)+1):bb[k])
{
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE); if(sum(ind)!=0) coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),"last"),-sum(as.numeric(coef.two[ind,2]))))
}
}
coef.two.rev=coef.pls3[c(42:516),]
ct.s=strsplit(coef.two.rev[,1], ":")
for (i in 1:length(ct.s)) {coef.two.rev[i,1]=paste(ct.s[[i]][2],ct.s[[i]][1],sep=":")}
for (k in 1:4){
for (j in 1:3)
for (i in (max(bb[k-1],0)+1):bb[k])
{
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two.rev[,1],fixed=TRUE); if(sum(ind)!=0) coef.two.rev=rbind(coef.two.rev,c(paste(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),"last"),-sum(as.numeric(coef.two.rev[ind,2]))))
}
}
coef.two=cbind(coef.two,coef.two.rev[,-c(1:475)])
coef.two=rbind(coef.two,coef.two.rev[,-c(1:475)])
dim(coef.two)
568-475
coef.two[476:568]
coef.two[476:568,]
coef.two=coef.pls3[c(42:516),]
for (k in 1:4){
for (j in 1:3)
for (i in (max(bb[k-1],0)+1):bb[k])
{
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE); if(sum(ind)!=0) coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),"last"),-sum(as.numeric(coef.two[ind,2]))))
}
}
dim(coef.two)
coef.two[476:568,]
coef.two.rev=coef.pls3[c(42:516),]
ct.s=strsplit(coef.two.rev[,1], ":")
for (i in 1:length(ct.s)) {coef.two.rev[i,1]=paste(ct.s[[i]][2],ct.s[[i]][1],sep=":")}
for (k in 1:4){
for (j in 1:3)
for (i in (max(bb[k-1],0)+1):bb[k])
{
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two.rev[,1],fixed=TRUE); if(sum(ind)!=0) coef.two.rev=rbind(coef.two.rev,c(paste(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),"last"),-sum(as.numeric(coef.two.rev[ind,2]))))
}
}
dim(coef.two.rev)
coef.two.rev[476:502,]
coef.two=rbind(coef.two,coef.two.rev[476:502,])
dim(coef.two)
595-476
coef.two[476:595,]
(coef.two[order(abs(coef.two[,2])),])[,2186:2196]
(coef.two[order(abs(as.numeric(coef.two[,2]))),])[,2186:2196]
order(abs(as.numeric(coef.two[,2])))
coef.two[,2]
as.numeric(coef.two[,2])
(coef.two[order(abs(as.numeric(coef.two[,2]))),])[2186:2196,]
coef.xxx=rbind(coef.one,coef.two)
dim(coef.xxx)
dim(coef.two)
coef.xxx=rbind(coef.one,coef.two,coef.pls[-c(:516)],)
coef.xxx=rbind(coef.one,coef.two,coef.pls[-c(:516),])
coef.xxx=rbind(coef.one,coef.two,coef.pls[-c(1:516),])
coef.xxx=rbind(coef.one,coef.two,coef.pls3[-c(1:516),])
dim(coef.xxx)
dim(coef.pls3)
coef.one=coef.pls3[2:41,]
for (i in 1:4) {ind=grepl(colnames(xs)[i],coef.one[,1],fixed=TRUE); coef.one=rbind(coef.one,c(paste(colnames(xs[i]),"last"),-sum(as.numeric(coef.one[ind,2]))))}
coef.two=coef.pls3[c(42:516),]
for (k in 1:4){
for (j in 1:3)
for (i in (max(bb[k-1],0)+1):bb[k])
{
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE); if(sum(ind)!=0) coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),"last"),-sum(as.numeric(coef.two[ind,2]))))
}
}
coef.two.rev=coef.pls3[c(42:516),]
ct.s=strsplit(coef.two.rev[,1], ":")
for (i in 1:length(ct.s)) {coef.two.rev[i,1]=paste(ct.s[[i]][2],ct.s[[i]][1],sep=":")}
for (k in 1:4){
for (j in 1:3)
for (i in (max(bb[k-1],0)+1):bb[k])
{
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two.rev[,1],fixed=TRUE); if(sum(ind)!=0) coef.two.rev=rbind(coef.two.rev,c(paste(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),"last"),-sum(as.numeric(coef.two.rev[ind,2]))))
}
}
coef.two=rbind(c("intercept",beta.hat[1]),coef.two,coef.two.rev[476:502,])
coef.one=coef.pls3[2:41,]
for (i in 1:4) {ind=grepl(colnames(xs)[i],coef.one[,1],fixed=TRUE); coef.one=rbind(coef.one,c(paste(colnames(xs[i]),"last"),-sum(as.numeric(coef.one[ind,2]))))}
coef.two=coef.pls3[c(42:516),]
for (k in 1:4){
for (j in 1:3)
for (i in (max(bb[k-1],0)+1):bb[k])
{
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two[,1],fixed=TRUE); if(sum(ind)!=0) coef.two=rbind(coef.two,c(paste(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),"last"),-sum(as.numeric(coef.two[ind,2]))))
}
}
coef.two.rev=coef.pls3[c(42:516),]
ct.s=strsplit(coef.two.rev[,1], ":")
for (i in 1:length(ct.s)) {coef.two.rev[i,1]=paste(ct.s[[i]][2],ct.s[[i]][1],sep=":")}
for (k in 1:4){
for (j in 1:3)
for (i in (max(bb[k-1],0)+1):bb[k])
{
ind=grepl(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),coef.two.rev[,1],fixed=TRUE); if(sum(ind)!=0) coef.two.rev=rbind(coef.two.rev,c(paste(paste(colnames(xf)[i],(colnames(xs)[-k])[j],sep=":"),"last"),-sum(as.numeric(coef.two.rev[ind,2]))))
}
}
coef.two=rbind(coef.two,coef.two.rev[476:502,])
#need to add three interactions, but they seem to be small as well
coef.xxx=rbind(c("intercept",beta.hat[1]),coef.one,coef.two)
dim(coef.xxx)
coef.xxx=rbind(c("intercept",beta.hat[1]),coef.one,coef.two,coef.pls3[-c(1:516),])
dim(coef.xxx)
(coef.xxx[order(abs(as.numeric(coef.xxx[,2]))),])[2300:2320,]
unique(xs[,1])
unique(x[,1])
unique(x[,23])
unique(x[,50])
unique(x[,50])
unique(x[,60])
q()
